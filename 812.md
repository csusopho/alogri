[Problem: 812. 最大三角形面积](https://leetcode.cn/problems/largest-triangle-area/description/)

### 方法：数学

三角形的面积怎么求？小学教的是 $底\times高/2$。

本题只有坐标，无法求出高，总不能先求直线方程，然后求点到直线距离？那太麻烦了。因此，初中教的是 **海伦-秦九韶** 算法。

已知三角形三边长 $a, b, c$，先计算半周长 $p = (a + b + c) / 2$，那么面积

$$
S = \sqrt{p(p-a)(p-b)(p-c)}
$$

点坐标 $A(x_1, y_1),B(x_2, y_2)$，则边长 $AB=\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$。注意，公式中含有根号！那么计算时比较麻烦，某些题会有精度问题。怎么办？

参考百度百科，我们可以构造已知图形，来求解未知图形，如下图

![pic](https://pic.leetcode.cn/1758939131-jfkeAz-image.png)

三角形 $ABC$ 的面积 $S=S_{总}-S_1-S_2-S_3$。

矩形面积，可以使用长 $\times$ 宽；小三角形面积，可以用底 $\times$ 高除以 $2$。因此，很容易得到

$$
S = \frac{1}{2} \left|
x_1(y_2 - y_3) +
x_2(y_3 - y_1) +
x_3(y_1 - y_2)
\right|
$$

上式就是重要的 **行列式公式**。

当然，我们也可以从另外一个角度进行解析：三角形面积 = 菱形面积 $/2$。而菱形的面积非常好求，只需要让两个向量相乘即可。

$$
\vec{AB} = (x_2 - x_1,\; y_2 - y_1), \quad
\vec{AC} = (x_3 - x_1,\; y_3 - y_1)
$$

利用二维向量的叉积（在二维中视为 $z$ 分量）：

$$
\vec{AB} \times \vec{AC} = (x_2-x_1)(y_3-y_1) - (x_3-x_1)(y_2-y_1)
$$

则可迅速得出第二个重要公式：**向量叉积公式**。

$$
S = \frac{1}{2} \left| \vec{AB} \times \vec{AC} \right|
= \frac{1}{2} \left| (x_2-x_1)(y_3-y_1) - (x_3-x_1)(y_2-y_1) \right|
$$

同理，可以将三角形的面积表示为几个沿 $x$ 轴构造的梯形的面积之和或差。

从三个顶点 $A, B, C$ 分别向 $x$ 轴作垂线，得到垂足 $D(x_1, 0)$，$E(x_2, 0)$，和 $F(x_3, 0)$。这样就形成了三个梯形：梯形 $ABED$、梯形 $BCFE$、梯形 $ACFD$。

根据梯形的面积公式 $\text{S} = \frac{1}{2}(\text{上底} + \text{下底}) \times \text{高}$，我们可以得到：

- $S_{ABED} = \frac{1}{2}(y_1 + y_2)(x_2 - x_1)$
- $S_{BCFE} = \frac{1}{2}(y_2 + y_3)(x_3 - x_2)$
- $S_{ACFD} = \frac{1}{2}(y_1 + y_3)(x_3 - x_1)$

三角形 $ABC$ 的面积可以通过这三个梯形的面积进行 “割” 和 “补” 来得到：

$$
\triangle ABC = \text{梯形 ABED} + \text{梯形 BCFE} - \text{梯形 ACFD}
$$

带入展开，可以得到第三个重要公式：**鞋带公式**。

$$
S = \frac{1}{2}\left|
(x_1y_2 + x_2y_3 + x_3y_1) - (x_2y_1 + x_3y_2 + x_1y_3)
\right|
$$

本质上来说，它们殊途同归。如果将第一种公式结果变为二阶行列式

$$
S = \left| \frac{1}{2}
\begin{vmatrix}
x_2 - x_1 & y_2 - y_1 \\
x_3 - x_1 & y_3 - y_1
\end{vmatrix} \right|
$$

则能得到第二个公式。同理，变为三阶行列式

$$
S = \left| \frac{1}{2}
\begin{vmatrix}
1 & 1 & 1 \\
x_1 & x_2 & x_3 \\
y_1 & y_2 & y_3
\end{vmatrix} \right|
$$

则能得到第三个公式。

本题的数据量非常小，点的总数 $n\leq 50$，因此直接用三重 $for$ **暴力** 即可！如果数据量增大，可以使用排序+凸包解决。

这里我采用第二种向量公式，写出下面的代码：

```Python
# python
class Solution:
    def largestTriangleArea(self, points: List[List[int]]) -> float:
        n = len(points)
        ans = 0.0

        # 三层循环
        for i in range(n):
            for j in range(i + 1, n):
                for k in range(j + 1, n):
                    # 获取三个点的坐标
                    x1, y1 = points[i]
                    x2, y2 = points[j]
                    x3, y3 = points[k]

                    # Area = 0.5 * |x1(y2 - y3) + x2(y3 - y1) + x3(y1 - y2)|
                    current_area = 0.5 * abs(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))

                    # 更新最大面积
                    if current_area > ans:
                        ans = current_area
        
        return ans
```

```Java
// java
class Solution {
    public double largestTriangleArea(int[][] points) {
        int n = points.length;
        double ans = 0.0;

        // 三层循环
        for (int i = 0; i < n; i++) {
            for (int j = i + 1; j < n; j++) {
                for (int k = j + 1; k < n; k++) {
                    // 获取三个点的坐标
                    int x1 = points[i][0];
                    int y1 = points[i][1];
                    int x2 = points[j][0];
                    int y2 = points[j][1];
                    int x3 = points[k][0];
                    int y3 = points[k][1];

                    // Area = 0.5 * |x1(y2 - y3) + x2(y3 - y1) + x3(y1 - y2)|
                    double currentArea = 0.5 * Math.abs(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2));

                    // 更新最大面积
                    if (currentArea > ans) {
                        ans = currentArea;
                    }
                }
            }
        }
        
        return ans;
    }
}
```

- 时间复杂度： $O(n^3)$，其中 $n$ 为数组 $points$ 的长度
- 空间复杂度： $O(1)$，仅使用常数个额外变量

如果本篇题解你觉得写得不错，欢迎点个赞让更多人看见~

> 题解已发布力扣平台 [我的题解](https://leetcode.cn/problems/largest-triangle-area/solutions/3793239/tu-jie-huan-zai-yong-qin-jiu-shao-suan-f-5r48/)
