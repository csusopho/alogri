[Problem: 1716. 计算力扣银行的钱](https://leetcode.cn/problems/calculate-money-in-leetcode-bank/description/)

### 方法：模拟 & 数学

在一周内，每天比前一天多 $1$ 块钱；当前周一，比上周一多 $1$ 块钱。

直接 **模拟** $n$ 天，累加每天的存款，代码如下，已附加注释：

```Python
# python
class Solution:
    def totalMoney(self, n: int) -> int:
        ans = 0
        a1 = 1  # 周一的钱

        for day in range(1, n + 1):
            # 本周的第几天
            day_of_week = (day - 1) % 7

            # 计算当天的存款额
            # 存款额 = 本周一的存款额 + 这是本周的第几天
            cur_deposit = a1 + day_of_week
            
            # 累加
            ans += cur_deposit

            # 周日，则下一个周一的存款额就要加 1
            if day % 7 == 0:
                a1 += 1
        
        return ans
```

```Java
// java
class Solution {
    public int totalMoney(int n) {
        int ans = 0;
        int a1 = 1; // 周一的钱

        for (int day = 1; day <= n; day++) {
            // 本周的第几天
            int dayOfWeek = (day - 1) % 7;

            // 计算当天的存款额
            // 存款额 = 本周一的存款额 + 这是本周的第几天
            int curDeposit = a1 + dayOfWeek;
            
            // 累加
            ans += curDeposit;

            // 如果是周日，则下一个周一的存款额就要加 1
            if (day % 7 == 0) {
                a1++;
            }
        }
        
        return ans;
    }
}
```

- 时间复杂度： $O(n)$，线性遍历
- 空间复杂度： $O(1)$，仅使用常数个额外变量

---

### 数学

我们可以将问题分解为两个部分：

1. **完整周** 的存款总和
2. **剩余天数**（不足一周）的存款总和

看看示例 $3$，每周的存款总额构成一个 **等差数列**：

- 第 $1$ 周的总存款：`1 + 2 + 3 + 4 + 5 + 6 + 7 = 28`
- 第 $2$ 周的总存款：`2 + 3 + 4 + 5 + 6 + 7 + 8 = 35`
- 第 $3$ 周的总存款：`3 + 4 + 5 + 6 + 7 + 8 + 9 = 42`

这是一个首项为 $28$，公差为 $7$ 的等差数列。

那么，我们可以计算出 $n$ 天内有多少个完整的周（项数），以及第一周的存款额（首项）和最后那个完整周的存款额（末项），然后使用 *求和公式* 来计算所有 **完整周** 的总存款。

**等差数列求和公式**：`(首项 + 末项) * 项数 / 2`。

完整周数是 $n/7$，最后一周可能不足 $7$ 天，需要单独计算剩下的 $n\% 7$ 天的存款。

- 这一周的周一存款额是 `(完整周数 + 1)`，也即 $b1=n/7+1$；
- 这一周一共 $n\%7$ 天，那么最后一天 $b2=b1+n\%7-1$；
- 然后，从这个周一的存款额开始，计算剩余几天的总和。这同样是一个简单的等差数列，利用求和公式快速计算即可。

将 “完整周的总存款” 和 “剩余天数的总存款” 相加，得到最终结果。

代码如下，已附加注释：

```Python
# python
class Solution:
    def totalMoney(self, n: int) -> int:
        week = n // 7  # 完整周数
        day = n % 7    # 剩余天数
        
        # 计算完整周的存款总额
        # 第一周存款总额
        a1 = 28
        # 最后一周存款总额
        aw = a1 + 7 * (week - 1)
        # 完整周总存款
        s1 = (a1 + aw) * week // 2
        
        # 计算剩余天数的存款总额
        # 剩余第一天存款
        b1 = 1 + week
        # 剩余最后一天存款
        bd = b1 + (day - 1)
        # 剩余天数总存款
        s2 = (b1 + bd) * day // 2
        
        # 总存款 = 完整周存款 + 剩余天数存款
        return s1 + s2
```

```Java
// java
class Solution {
    public int totalMoney(int n) {
        int week = n / 7; // 完整周数
        int day = n % 7;  // 剩余天数

        // 计算完整周的存款总额
        // 第一周存款总额
        int a1 = 28;
        // 最后一周存款总额
        int aw = a1 + 7 * (week - 1);
        // 完整周总存款
        int s1 = (a1 + aw) * week / 2;

        // 计算剩余天数的存款总额
        // 剩余第一天存款
        int b1 = 1 + week;
        // 剩余最后一天存款
        int bd = b1 + (day - 1);
        // 剩余天数总存款
        int s2 = (b1 + bd) * day / 2;

        // 总存款 = 完整周存款 + 剩余天数存款
        return s1 + s2;
    }
}
```

- 时间复杂度： $O(1)$，仅包含数学运算
- 空间复杂度： $O(1)$

---

### 简化

规定完整周数是 $a$，剩余 $b$ 天。在第一个等差数列中，

- 首项 $a_1$： $28$
- 末项 $a_a$：第 $a$ 周的和，即 $7*a + 21$
- 项数： $a$
- 总和 = $(28 + (7*a + 21)) * a / 2$ = $(49 + 7*a) * a / 2$

得出第一个公式： $(49 + 7 * a) * a / 2$。在第二个等差数列中，

- 首项： $a + 1$
- 末项： $a + b$
- 项数： $b$
- 总和 = $((a + 1) + (a + b)) * b / 2$ = $(2*a + b + 1) * b / 2$

得出第二个公式： $(2 * a + b + 1) * b / 2$。

累加这两个公式，直接 **一步到位**，从而大幅度简化代码。

代码如下，已附加注释：

```Python
# python
class Solution:
    def totalMoney(self, n: int) -> int:
        a = n // 7
        b = n % 7
        
        # 所有完整周的总金额
        full_weeks_sum = (49 + 7 * a) * a // 2
        
        # 剩余天数的总金额
        remaining_days_sum = (2 * a + b + 1) * b // 2
        
        return full_weeks_sum + remaining_days_sum
```

```Java
// java
class Solution {
    public int totalMoney(int n) {
        int a = n / 7;
        int b = n % 7;
        
        // 所有完整周的总金额
        int full_weeks_sum = (49 + 7 * a) * a / 2;
        
        // 剩余天数的总金额
        int remaining_days_sum = (2 * a + b + 1) * b / 2;
        
        return full_weeks_sum + remaining_days_sum;
    }
}
```

- 时间复杂度： $O(1)$
- 空间复杂度： $O(1)$

如果本篇题解你觉得写得不错，欢迎点个赞让更多人看见~

> 题解已发布力扣平台 [我的题解](https://leetcode.cn/problems/calculate-money-in-leetcode-bank/solutions/3814945/san-jie-mo-ni-deng-chai-shu-lie-jian-hua-1ufy/)
