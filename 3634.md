[Problem: 3634. 使数组平衡的最少移除数目](https://leetcode.cn/problems/minimum-removals-to-balance-array/description/)

### 排序

题目要求移除 “最小” 数量的元素，转化思路，等同于 **保留“最大”数量的元素**。

在一个无序数组中，寻找满足条件的子集比较困难。但是，如果我们把数组 **从小到大排序**，任意选取一个连续的子数组 $nums[i...j]$，那么：

- 该子数组的最小值一定是 $nums[i]$。
- 该子数组的最大值一定是 $nums[j]$。
- 中间的所有元素都介于两者之间，不会破坏平衡条件。

因此，问题就转化为了：在排序后的数组中，寻找一个最长的连续子数组，满足 $nums[j]\leq nums[i]\times k$。

> 由于题目说明移除任意元素，所以本质是挑选子序列，排序打乱顺序没有问题。

如何寻找最长子数组？使用 **滑动窗口**。使用两个指针 $left$ 和 $right$。其中，

- $right$ 指针主动向右扩展，表示尝试加入更大的元素。
- 当新加入的 $nums[right]$ 导致窗口不再平衡，说明最小值 $nums[left]$ 太小了，无法匹配当前的 $nums[right]$。
- 此时，将 $left$ 指针向右移动，直到窗口重新满足条件。
- 在每一步中，记录窗口的最大长度。

在上述过程中，维护窗口的最大长度，则总长 $n$ 减去该值就是答案。

代码如下，已附加注释：

```Python
# python
class Solution:
    def minRemoval(self, nums: List[int], k: int) -> int:
        nums.sort()
        n = len(nums)
        max_keep = 0  # 能保留的最大元素数量
        left = 0      # 左指针

        for right in range(n):
            # 条件不满足，收缩左边界
            while nums[right] > nums[left] * k:
                left += 1
            
            # 当前窗口合法
            cur_len = right - left + 1
            max_keep = max(max_keep, cur_len)
        
        # 总数 - 最多能保留的个数
        return n - max_keep
```

```Java
// java
class Solution {
    public int minRemoval(int[] nums, int k) {
        Arrays.sort(nums);
        int n = nums.length;
        int maxKeep = 0;  // 能保留的最大元素数量
        int left = 0;     // 左指针

        for (int right = 0; right < n; right++) {
            // 条件不满足，收缩左边界
            while (nums[right] > (long) nums[left] * k) {
                left++;
            }
            
            // 当前窗口合法
            int curLen = right - left + 1;
            maxKeep = Math.max(maxKeep, curLen);
        }
        
        // 总数 - 最多能保留的个数
        return n - maxKeep;
    }
}
```

- 时间复杂度： $O(n\times logn)$，其中 $n$ 为数组 $nums$ 的长度，时间瓶颈在于快排，每个元素至多移入/出窗口一次
- 空间复杂度： $O(1)$，忽略排序的 $O(logn)$ 栈开销

如果本篇题解你觉得写得不错，欢迎点个赞让更多人看见~

> 题解已发布力扣平台 [我的题解](https://leetcode.cn/problems/minimum-removals-to-balance-array/solutions/3897349/pai-xu-yi-chu-zui-shao-bao-liu-zui-duo-z-1kg0/)
